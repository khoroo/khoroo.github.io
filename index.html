<!DOCTYPE html>
<html>
<head>
  <title>Lorenz Attractor</title>
</head>
<body>
  <canvas id="canvas" width="800" height="800"></canvas>

  <script>
    class Lorenz {
      constructor() {
        // Classic Lorenz parameters
        this.sigma = 10;    // Prandtl number
        this.rho = 28;      // Rayleigh number
        this.beta = 8/3;    // Physical proportion
        
        // Initial conditions (small perturbation from origin)
        this.x = 0.1;
        this.y = 0.1;
        this.z = 0.1;
        
        // Visualization parameters
        this.scale = 10;
        this.offsetX = 400;
        this.offsetY = 400;
        this.rotationY = Math.PI/4; // Add some rotation for better 3D effect
      }

      // RK4 integration step
      next() {
        const dt = 0.004;  // Time step
        const k1 = this.derivatives(this.x, this.y, this.z);
        const k2 = this.derivatives(
          this.x + dt*k1.x/2, 
          this.y + dt*k1.y/2, 
          this.z + dt*k1.z/2
        );
        const k3 = this.derivatives(
          this.x + dt*k2.x/2, 
          this.y + dt*k2.y/2, 
          this.z + dt*k2.z/2
        );
        const k4 = this.derivatives(
          this.x + dt*k3.x, 
          this.y + dt*k3.y, 
          this.z + dt*k3.z
        );

        // Update state
        this.x += dt * (k1.x + 2*k2.x + 2*k3.x + k4.x) / 6;
        this.y += dt * (k1.y + 2*k2.y + 2*k3.y + k4.y) / 6;
        this.z += dt * (k1.z + 2*k2.z + 2*k3.z + k4.z) / 6;

        // Simple perspective projection
        const cosY = Math.cos(this.rotationY);
        const sinY = Math.sin(this.rotationY);
        
        // Rotate around Y axis and apply scale/offset
        return {
          x: (this.x * cosY - this.z * sinY) * this.scale + this.offsetX,
          y: this.y * this.scale + this.offsetY
        };
      }

      // The Lorenz system equations
      derivatives(x, y, z) {
        return {
          x: this.sigma * (y - x),
          y: x * (this.rho - z) - y,
          z: x * y - this.beta * z
        };
      }
    }

    // Setup canvas
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    
    // Set black background
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Initialize system
    const attractor = new Lorenz();

    // Set drawing style - using blue hue for classic Lorenz look
    ctx.strokeStyle = 'rgba(100, 200, 255, 0.1)';
    ctx.lineWidth = 0.5;

    // Previous point for line drawing
    let prevPoint = attractor.next();

    // Animation function
    function draw() {
      // Draw multiple points per frame
      for(let i = 0; i < 100; i++) {
        const point = attractor.next();
        
        ctx.beginPath();
        ctx.moveTo(prevPoint.x, prevPoint.y);
        ctx.lineTo(point.x, point.y);
        ctx.stroke();
        
        prevPoint = point;
      }
      
      requestAnimationFrame(draw);
    }

    // Start animation
    draw();
  </script>
</body>
</html>
